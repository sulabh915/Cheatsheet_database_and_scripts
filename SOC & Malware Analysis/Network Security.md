

Using tcpdump :
```bash
tcpdump [option] [expression]

#check for adapter
tcpdump -i eth0

#list all adapter 
tcpdump -D 

#check for detail packet received
tcpdump -i lo -X

#print full ascii character :
tcpdump -i lo -A

#no dns name resolution :
tcpdump -i lo -n

#using the filters:
tcpdump -i eth0 -n host example.com 
tcpdump -i eth0 -n src <ip address>
tcpdump -i eth0 -n dst <ip address>
tcpdump -i eth0 -n net <ip address>/cidr
tcpdump -i eth0 -n src net <ip address>/cidr
tcpdump -i eth0 -n dst net <ip address>/cidr
tcpdump -i eth0 -n port 3389
tcpdump -i eth0 -n src port 22
tcpdump -i eth0 -n dst port 21

#using the logical operators:
tcpdump -i eth0 -n 'src 10.0.210 and not port 22'
tcpdump -i eth0 -n 'src 10.0.2.15 and dst 40.123.123.123 and not (port 443 or port 22)'
tcpdump -i eth0 -n icmp , arp #filter with protocol.

#save to file and read from :
sudo tcpdump -i eth0 -n -w ./capture.pcap
sudo tcpdump -i eth0 -n -r ./capture.pcap
sudo tcpdump -i eth0 -n -r ./capture.pcap  --count
sudo tcpdump -i eth0 -n -r ./capture.pcap  -c 4 #show first four capture.
sudo tcpdump -i eth0 -n -r ./capture.pcap  -tttt,-ttt,-tt,-t #show different timestamp
sudo tcpdump -r ./capture.pcap port 80 and host 10.0.0.18 | grep -E "GET|POST"

#finding most communicate ip in logs file 
source ip :
tcpdump -tt -r 2024-04-18.pcap -n tcp | cut -d " " -f 3 | cut -d "."  -f 1-4 | sort | uniq -c | sort -nr

destination ip :
tcpdump -tt -r 2024-04-18.pcap -n tcp | cut -d " " -f 5 | cut -d "."  -f 1-4 | sort | uniq -c | sort -nr

#checkout port for most communicate ip.
tcpdump -tt -r 2024-04-18.pcap -n tcp and src 10.4.18.169 and dst 85.239.53.219 | cut -d " " -f 5 | cut -d "."  -f 5 | sort | uniq -c | sort -nr

tcpdump -tt -r 2024-04-18.pcap -n tcp and dst 10.4.18.169 and dst 85.239.53.219 | cut -d " " -f 5 | cut -d "."  -f 5 | sort | uniq -c | sort -nr

```
